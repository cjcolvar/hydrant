
<div class="document_viewer" id="cover_container">

	<h1>
		<% unless get_values_from_datastream(@document_fedora,"descMetadata", [:title]).first.empty? %>
	      <%= get_values_from_datastream(@document_fedora,"descMetadata", [:title]).first %>
		<% else %>
			<%= params[:id] %>
		 <% end %>
	</h1>

	<% unless @document_fedora.file_objects(:response_format=>:solr).hits.empty? %>
<script>
 function failed(e) {
   // video playback failed - show a message saying why
   switch (e.target.error.code) {
     case e.target.error.MEDIA_ERR_ABORTED:
       alert('You aborted the video playback.');
       break;
     case e.target.error.MEDIA_ERR_NETWORK:
       alert('A network error caused the video download to fail part-way.');
       break;
     case e.target.error.MEDIA_ERR_DECODE:
       alert('The video playback was aborted due to a corruption problem or because the video used features your browser did not support.');
       break;
     case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:
       alert('The video could not be loaded, either because the server or network failed or because the format is not supported.');
       break;
     default:
       alert('An unknown error occurred.');
       break;
   }
 }
</script>
	<div class="video_player">
	  <video width="320" height="240" controls preload id="video1" onerror="failed(event)">
	    <source src="<%= file_asset_path(@document_fedora.file_objects(:response_format=>:solr).hits.first["id"]) %>" type='video/ogg; codecs="theora, vorbis"'/>
	    Your browser does not support the video tag.
	  </video>
	</div>
	<% end %>


    <%= render :partial => 'videos/show_description' %>


	<% unless @document_fedora.file_objects(:response_format=>:solr).hits.empty? %>
		<fieldset><legend>Files</legend>
	    <div class="uploads" id="<%= format_pid(params[:id]) %>">	
		  <table id="file_assets" class="multipleEdit">
		    <tr>
		      <th>File Name</th>
		      <th>Size</th>
		      <th>Uploaded</th>
		    </tr>
		
			<% @document_fedora.file_objects(:response_format=>:solr).each do |result| %>
			<tr class="file_asset" >
			  <td>
			    <%= link_to result[solr_name("title", :text)], file_asset_path(result["id"]) %>
			  </td>
			  <td>
			    <%= result[solr_name("extent", :text)] %>
			  </td>
			  <td>
			    <% dt = DateTime.parse(result[ solr_name("system_create", :date)] ) %>
			    <%= format_date dt %>
			  </td>
			</tr>
			<% end %>		
		  </table>	
			</div>
 		</fieldset>
	<% end %>

</div>
